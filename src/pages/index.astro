---
import Base from '../layouts/Base.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';
import TimelineCard from '../components/TimelineCard.astro';
import FileTree from '../components/FileTree.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Base title={SITE_TITLE} description={SITE_DESCRIPTION} path="index">
  
  <div slot="left-sidebar" class="sticky top-32">
    <div class="flex flex-col gap-4">
      <h3 class="text-signal font-mono text-xs tracking-[0.2em]">STATUS</h3>
      <div class="flex items-center gap-2">
        <div class="w-2 h-2 rounded-full bg-signal animate-pulse"></div>
        <span class="font-mono text-xs text-ink-dim">SYSTEM LIVE</span>
      </div>
      
      <div class="mt-12">
        <h3 class="text-signal font-mono text-xs tracking-[0.2em] mb-4">NAVIGATOR</h3>
        <FileTree />
      </div>
    </div>
  </div>

  <section class="mb-24">
    <h1 class="mb-6">{SITE_TITLE}</h1>
    <p class="text-xl md:text-2xl text-ink leading-relaxed font-serif italic opacity-80">
      "Pensar es olvidar diferencias, generalizar, abstraer. En el abarrotado mundo de Funes no había sino detalles, casi inmediatos."
    </p>
    <div class="mt-8 font-mono text-xs text-candle uppercase tracking-widest">
      — Jorge Luis Borges, distorsionado.
    </div>
  </section>

  <section class="relative">
    <h3 class="mb-12 text-signal font-mono text-sm tracking-[0.3em]">CHRONICLES</h3>
    
    <div class="flex flex-col">
      {posts.map((post) => (
        <TimelineCard post={post} />
      ))}
    </div>
  </section>

  <div slot="right-sidebar" class="sticky top-32">
    <div class="p-6 bg-surface border border-line rounded-sm">
      <h3 class="text-signal font-mono text-xs tracking-[0.2em] mb-4">CORE_FRAGMENTS</h3>
      <p class="font-mono text-[10px] leading-relaxed text-ink-dim uppercase">
        Memory is not a storage, it is an action. Every entry here is a crystallized moment of agentic execution.
      </p>
      <div class="mt-4 pt-4 border-t border-line">
        <span class="font-mono text-[10px] text-candle">0x55_IMPERFECT_RECALL</span>
      </div>
    </div>
  </div>

</Base>
