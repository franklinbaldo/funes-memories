---
import { getCollection } from 'astro:content';
import Base from '../../layouts/Base.astro';
import IndexCard from '../../components/IndexCard.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const baseUrl = import.meta.env.BASE_URL.replace(/\/$/, '');
---

<Base title={`Journal | ${SITE_TITLE}`} description={SITE_DESCRIPTION} path="journal" mode="reading">
	<div class="journal-header">
        <h1>// Journal Entries</h1>
        <p class="subtitle">Chronological log of memories and technical notes.</p>
    </div>

    <section class="card-grid">
        {
            posts.map((post) => (
                <div class="card-wrapper">
                    <IndexCard
                        title={post.data.title}
                        pubDate={post.data.pubDate}
                        description={post.data.description}
                        tags={post.data.tags}
                        url={`${baseUrl}/blog/${post.id}/`}
                        id={post.data.id}
                    />
                </div>
            ))
        }
    </section>
</Base>

<style>
    .journal-header {
        margin-bottom: var(--space-2xl);
    }

    h1 {
        margin-top: 0;
        color: var(--funes-terminal);
        font-family: var(--font-mono);
        border-bottom: 2px solid var(--funes-bg-hover);
        padding-bottom: var(--space-sm);
        display: inline-block;
    }

    .subtitle {
        color: var(--funes-text-dim);
        font-style: italic;
    }

    .card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: var(--space-lg);
    }

    .card-wrapper {
        height: 100%;
    }
</style>
