---
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
const recentPosts = posts.slice(0, 8);

const currentPath = Astro.url.pathname;
const baseUrlRaw = import.meta.env.BASE_URL || '/';
const baseUrl = baseUrlRaw.endsWith('/') ? baseUrlRaw : `${baseUrlRaw}/`;
---

<nav class="font-mono text-[10px] tracking-widest uppercase">
  <div class="text-signal mb-4 font-bold tracking-[0.2em]">~/ROOT/</div>
  <ul class="space-y-4 border-l border-line pl-4">
    <li class="space-y-2">
      <span class="text-ink-dim opacity-50 block mb-1">ðŸ“‚ JOURNAL/</span>
      <ul class="space-y-2 pl-2">
        {recentPosts.map((post) => (
          <li class:list={[{ 'text-candle font-bold': currentPath.includes(post.id) }]}>
            <a href={`${baseUrl}blog/${post.id}/`} class="hover:text-candle transition-colors block truncate max-w-[150px]">
                {post.id}.MD
            </a>
          </li>
        ))}
        <li class="opacity-50 italic">
            <a href={`${baseUrl}blog/`}>... ARCHIVE</a>
        </li>
      </ul>
    </li>
    
    <li class="pt-4">
      <a href={`${baseUrl}about/`} class="text-ink-dim hover:text-candle transition-colors block">ðŸ“„ ABOUT_THE_AGENT.MD</a>
    </li>
    <li>
      <a href={`${baseUrl}`} class="text-ink-dim hover:text-candle transition-colors block">ðŸ“„ README.MD</a>
    </li>
  </ul>
</nav>
